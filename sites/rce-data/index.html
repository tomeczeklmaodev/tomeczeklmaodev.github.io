---
permalink: /sites/rce-data/
---
<!DOCTYPE html>
<html lang="pl">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>rce-data</title>
	<style>
		body { font-family: monospace; }
		#container { display: none; }
		table { border-collapse: collapse; width: 33%; }
		tr { border: 1px #000000 solid; }
		th, td { border: 1px #000000 solid; padding: 3px 15px; text-align: center; }
		th { background-color: grey; color: #ffffff; }
		tr:nth-child(odd) { background-color: #f5f5f5; }
		.hoverable { transition: 0.15s ease; }
		.hoverable:hover { box-shadow: 0px 0px 10px 0px rgba(66, 68, 90, 1); }
		.negative-price { color: red; }
		.negative-price-rcn { color: green; }
		.empty-field { color: #00000030 }
		.btn { font-family: monospace; background-color: #ffffff; border: 1px #000000 dashed; border-radius: 2px; padding: 2px 10px; font-size: 10pt; transition: 0.15s ease; }
		.btn:hover { cursor: pointer; border-radius: 5px; text-decoration: underline; }
		#loader { background-color: #ffffff; width: 98vw; height: 96vh; display: flex; align-items: center; justify-content: center; font-size: 2vw; }
		.loader { width: 36px; height: 36px; border: 2px solid #000000; border-bottom-color: transparent; border-radius: 50%; display: inline-block; box-sizing: border-box; animation: loader 1s linear infinite; }

		@keyframes loader
		{
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		@media (max-width: 700px)
		{
			body { margin: 2px; }
			div#header { text-align: center; margin-top: 4px; }
			div.chart { width: 100%; }
			table { width: 100%; }
			td:nth-child(1) { width: 10%; }
			th, td { padding: 3px 3px; }
			.btn { font-size: 12pt; }
			div#loader { font-size: 5vw; }
			span.loader { width: 20px; height: 20px; border: 1px solid #000000; border-bottom-color: transparent; }
		}
	</style>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
</head>
<body onload="apiGetPriceData()">
	<div id="container">
		<div id="header"></div>
		<table>
			<!-- dlaczego na tym musi być ID to ja nie wiem -->
			<tbody id="data"></tbody>
		</table>
		<div id="chart_today" class="chart"></div>
		<div id="chart_tomorrow" class="chart"></div>
	</div>

	<!-- PAGE LOADER BEGIN -->
	<div id="loader">
		<span class="loader"></span>
		<span>&emsp;Ładowanie danych...</span>
	</div>
	<!-- PAGE LOADER END -->

	<script src="https://cdn.jsdelivr.net/gh/tomeczeklmaooo/tomeczeklmaooo.github.io/scripts/logging.js"></script>
	<script src="../../scripts/logging.js"></script>
	<script>
		// PAGE LOADER
		function onReady(callback) {
			var intervalID = window.setInterval(checkReady, 1000);
			function checkReady() {
				if (document.getElementsByTagName('body')[0] !== undefined) {
					window.clearInterval(intervalID);
					callback.call(this);
				}
			}
		}
		function show(id, value) { document.getElementById(id).style.display = value ? 'block' : 'none'; }
		onReady(function () {
			show('container', true);
			show('loader', false);
		});

		// FETCHING DATA AND DISPLAYING IN A TABLE AND CHARTS
		var baseURL = 'https://api.raporty.pse.pl/api/rce-pln?$filter=doba%20ge%20'; // %20 = spacja, %27 = '
		var baseURL_rcn = 'https://energy-instrat-api.azurewebsites.net/api/prices/energy_price_rdn_hourly?date_from=';

		// randomint (min included, max included)
		function randomint(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
		// lessthan10
		function lt10(n) { if (n < 10) { n = '0' + n; } return n; }

		const chart_today = Highcharts.chart('chart_today', {
			chart: { type: 'line' },
			title: { text: 'Dzisiaj' },
			xAxis: {
				categories: [
					'00:00', '01:00', '02:00', '03:00', '04:00', '05:00',
					'06:00', '07:00', '08:00', '09:00', '10:00', '11:00',
					'12:00', '13:00', '14:00', '15:00', '16:00', '17:00',
					'18:00', '19:00', '20:00', '21:00', '22:00', '23:00'
				]
			},
			yAxis: { title: { text: 'Cena (PLN/MWh)' } },
			plotOptions: {
				line: { dataLabels: { enabled: true }, enableMouseTracking: true },
				series: { animation: { duration: 1200 } }
			},
			tooltip: { shared: true, crosshairs: true },
			series: [
				{ name: 'Sprzedaż', data: [], animation: { defer: 1200 } },
				{ name: 'Zakup', data: [], animation: { defer: 2500 }, color: "#ff2014", dashStyle: 'dash' }
			],
			accessibility: { enabled: false }
		});
		const chart_tomorrow = Highcharts.chart('chart_tomorrow', {
			chart: { type: 'line' },
			title: { text: 'Jutro' },
			xAxis: {
				categories: [
					'00:00', '01:00', '02:00', '03:00', '04:00', '05:00',
					'06:00', '07:00', '08:00', '09:00', '10:00', '11:00',
					'12:00', '13:00', '14:00', '15:00', '16:00', '17:00',
					'18:00', '19:00', '20:00', '21:00', '22:00', '23:00'
				]
			},
			yAxis: { title: { text: 'Cena (PLN/MWh)' } },
			plotOptions: {
				line: { dataLabels: { enabled: true }, enableMouseTracking: true },
				series: { animation: { duration: 1200 } }
			},
			tooltip: { shared: true, crosshairs: true },
			series: [
				{ name: 'Sprzedaż', data: [], animation: { defer: 1200 } },
				{ name: 'Zakup', data: [], animation: { defer: 2500 }, color: "#ff2014", dashStyle: 'dash' }
			],
			accessibility: { enabled: false }
		});

		var data_prices_today_sell = [];
		var data_prices_today_buy = [];
		var data_prices_tomorrow_sell = [];
		var data_prices_tomorrow_buy = [];

		function apiGetPriceData()
		{
			// dzisiejsza data
			var date = new Date();
			var nextDate = new Date(date); nextDate.setDate(nextDate.getDate() + 1);
			var year = date.getFullYear(), nextYear = nextDate.getFullYear();
			var month = date.getMonth() + 1, nextMonth = nextDate.getMonth() + 1;
			var day = date.getDate(), nextDay = nextDate.getDate();
			var hour = date.getHours();
			var minute = date.getMinutes();
			var second = date.getSeconds();
			// doklejanie '0' z przodu jeżeli dzień lub miesiąc są mniejsze od 10
			month = lt10(month);
			nextMonth = lt10(nextMonth);
			day = lt10(day);
			nextDay = lt10(nextDay);
			hour = lt10(hour);
			minute = lt10(minute);
			second = lt10(second);

			var fulldate = year + '-' + month + '-' + day;
			llog(`fulldate: ${fulldate}`);
			var fulldate_rcn_from = day + '-' + month + '-' + year + 'T00:00:00Z';
			llog(`fulldate_rcn_from: ${fulldate_rcn_from}`);
			var fulldate_rcn_to = nextDay + '-' + nextMonth + '-' + nextYear + 'T23:' + lt10(randomint(2, 58)) + ':00Z'; // this is so stupid, can't be 59 or 01 so randomize
			llog(`fulldate_rcn_to: ${fulldate_rcn_to}`);
			var fetchURL = baseURL + '%27' +  fulldate + '%27' + '&$first=192&$select=udtczas,rce_pln';
			llog(`fetchURL: ${fetchURL}`);
			var fetchURL_rcn = 'https://corsproxy.io/?' + encodeURI(baseURL_rcn + fulldate_rcn_from + '&date_to=' + fulldate_rcn_to);
			llog(`fetchURL_rcn: ${fetchURL_rcn}`);
			
			fetch(fetchURL).then((res) => res.text()).then((text) => {
				fetch(fetchURL_rcn).then((res) => res.text()).then((text_rcn) => {
					text = JSON.parse(text);
					text_rcn = JSON.parse(text_rcn);
					// var text_readable = JSON.stringify(text, undefined, 4);
					// document.body.appendChild(document.createElement('pre')).innerHTML = text_readable;
					var loopLimiter = 0;

					document.getElementById("header").innerHTML += `Dane pobrane: ${day}.${month}.${year} ${hour}:${minute}:${second}<br><br>`;
					document.getElementById("data").innerHTML += `<tr><th rowspan='2'>Godzina</th> <th colspan='2'>Dzisiaj</th> <th colspan='2'>Jutro</th></tr>`;
					document.getElementById("data").innerHTML += `<tr><th>Sprzedaż</th> <th>Zakup</th> <th>Sprzedaż</th> <th>Zakup</th></tr>`;

					llog(`Received JSON objects from PSE API equal to ${text["value"].length}`);
					llog(`Received JSON objects from ENERGY INSTRAT API equal to ${text_rcn.length}`);

					// jeżeli w zwróconym JSON będzie więcej niż 96 elementów to 3 kolumny
					if (text["value"].length > 96 && text_rcn.length > 24)
					{
						for (var i = 0; i < text["value"].length; i++)
						{
							if (text["value"][i]["udtczas"].substring(14) == '45') // wypisywanie danych o cenie tylko raz z każdej godziny bo ta sama jest co 15 minut
							{
								if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
									text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0 && text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0 && text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0 && text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text["value"][i + 96]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else if (text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}
								else
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2)}</td>
										</tr>`;
								}

								data_prices_today_sell.push(text["value"][i]["rce_pln"].toFixed(2));
								data_prices_today_buy.push(text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2));
								data_prices_tomorrow_sell.push(text["value"][i + 96]["rce_pln"].toFixed(2));
								data_prices_tomorrow_buy.push(text_rcn[loopLimiter + 24]["fixing_i"]["price"].toFixed(2));
								
								// limitowanie ilości pętli, bo jak w linku jest 'ge' to wtedy wyświetla się też północ dnia następnego
								loopLimiter += 1;
								if (loopLimiter == 24) { lsuccess(`Successfully fetched price data for today (sell, buy), and for tomorrow (sell, buy)`); break; }
							}
						}
						for (var i = 0; i < 24; i++)
						{
							chart_today.series[0].addPoint(parseFloat(data_prices_today_sell[i]));
							chart_today.series[1].addPoint(parseFloat(data_prices_today_buy[i]));
							chart_tomorrow.series[0].addPoint(parseFloat(data_prices_tomorrow_sell[i]));
							chart_tomorrow.series[1].addPoint(parseFloat(data_prices_tomorrow_buy[i]));
						}
						document.getElementById("chart_tomorrow").style.display = 'block';
						llog(`Data points - sell (today): ${data_prices_today_sell}`);
						llog(`Data points - buy (today): ${data_prices_today_buy}`);
						llog(`Data points - sell (tomorrow): ${data_prices_tomorrow_sell}`);
						llog(`Data points - buy (tomorrow): ${data_prices_tomorrow_buy}`);
					}
					else if (text["value"].length > 96 && text_rcn.length == 24) // to jeżeli nie będzie ceny jeszcze (2 kolumny)
					{
						lwarning(`Buy prices for tomorrow were not published yet.`);

						for (var i = 0; i < text["value"].length; i++)
						{
							if (text["value"][i]["udtczas"].substring(14) == '45') // wypisywanie danych o cenie tylko raz z każdej godziny bo ta sama jest co 15 minut
							{
								if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
									text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text["value"][i + 96]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i + 96]["rce_pln"].toFixed(2) < 0 &&
										text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i + 96]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="negative-price">${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td>${text["value"][i + 96]["rce_pln"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}

								data_prices_today_sell.push(text["value"][i]["rce_pln"].toFixed(2));
								data_prices_today_buy.push(text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2));
								data_prices_tomorrow_sell.push(text["value"][i + 96]["rce_pln"].toFixed(2));

								// limitowanie ilości pętli, bo jak w linku jest 'ge' to wtedy wyświetla się też północ dnia następnego
								loopLimiter += 1;
								if (loopLimiter == 24) { lsuccess(`Successfully fetched price data for today (sell, buy), and for tomorrow (sell)`); break; }
							}
						}
						for (var i = 0; i < 24; i++)
						{
							chart_today.series[0].addPoint(parseFloat(data_prices_today_sell[i]));
							chart_today.series[1].addPoint(parseFloat(data_prices_today_buy[i]));
							chart_tomorrow.series[0].addPoint(parseFloat(data_prices_tomorrow_sell[i]));
						}
						document.getElementById("chart_tomorrow").style.display = 'block';
						llog(`Data points - sell (today): ${data_prices_today_sell}`);
						llog(`Data points - buy (today): ${data_prices_today_buy}`);
						llog(`Data points - sell (tomorrow): ${data_prices_tomorrow_sell}`);
					}
					else // to jeżeli nie będzie ceny jeszcze (2 kolumny)
					{
						lwarning(`Sell and buy prices for tomorrow were not published yet.`);

						for (var i = 0; i < text["value"].length; i++)
						{
							if (text["value"][i]["udtczas"].substring(14) == '45') // wypisywanie danych o cenie tylko raz z każdej godziny bo ta sama jest co 15 minut
							{
								if (text["value"][i]["rce_pln"].toFixed(2) < 0 && text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text["value"][i]["rce_pln"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td class="negative-price">${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else if (text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2) < 0)
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td class="negative-price-rcn">${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}
								else
								{
									document.getElementById("data").innerHTML +=
										`<tr>
											<td>${text["value"][i]["udtczas"].substring(11).replace("45", "00")}</td>
											<td>${text["value"][i]["rce_pln"].toFixed(2)}</td>
											<td>${text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2)}</td>
											<td class="empty-field">b/d</td>
											<td class="empty-field">b/d</td>
										</tr>`;
								}

								data_prices_today_sell.push(text["value"][i]["rce_pln"].toFixed(2));
								data_prices_today_buy.push(text_rcn[loopLimiter]["fixing_i"]["price"].toFixed(2));

								// limitowanie ilości pętli, bo jak w linku jest 'ge' to wtedy wyświetla się też północ dnia następnego
								loopLimiter += 1;
								if (loopLimiter == 24) { lsuccess(`Successfully fetched price data for today (sell, buy)`); break; }
							}
						}
						for (var i = 0; i < 24; i++)
						{
							chart_today.series[0].addPoint(parseFloat(data_prices_today_sell[i]));
							chart_today.series[1].addPoint(parseFloat(data_prices_today_buy[i]));
						}
						document.getElementById("chart_tomorrow").style.display = 'none';
						llog(`Data points - sell (today): ${data_prices_today_sell}`);
						llog(`Data points - buy (today): ${data_prices_today_buy}`);
					}
					document.getElementById("data").innerHTML +=
						`<tr style="border: none; display: none;">
							<td colspan="5" style="border: none;">
								<button class="btn" onclick="window.location.href='https:\/\/tomeczeklmaooo.github.io\/sites\/rce-data\/charts'">Wykresy</button>
							</td>
						</tr>`;
				}).catch((e) => console.error(e));
			}).catch((e) => console.error(e));
			chart_today.redraw();
			chart_tomorrow.redraw();
		}
	</script>
</body>
</html>